#ifndef AVIUM_CONFIG_H
#define AVIUM_CONFIG_H

// clang-format off
#define AVM_VERSION_MAJOR @PROJECT_VERSION_MAJOR@
#define AVM_VERSION_MINOR @PROJECT_VERSION_MINOR@
#define AVM_VERSION_PATCH @PROJECT_VERSION_PATCH@
#define AVM_LONG_TYPE @AVM_LONG_TYPE@
// clang-format on

#cmakedefine AVM_WIN32
#cmakedefine AVM_LINUX
#cmakedefine AVM_DARWIN
#cmakedefine AVM_MSVC
#cmakedefine AVM_GNU
#cmakedefine AVM_HAVE_UNICODE
#cmakedefine AVM_HAVE_BACKTRACE
#cmakedefine AVM_HAVE_WIN32_THREADS
#cmakedefine AVM_HAVE_POSIX_THREADS
#cmakedefine AVM_HAVE_PTHREAD_SETNAME
#cmakedefine AVM_HAVE_PTHREAD_BARRIER
#cmakedefine AVM_THROW_ON_CAST_FAIL
#cmakedefine AVM_THROW_AUTO_CLONE
#cmakedefine AVM_EXPOSE_HIDDEN_API
#cmakedefine AVM_INSERT_INIT_CODE
#cmakedefine AVM_BUILDING
#cmakedefine AVM_DISABLE_PRECONDITIONS
#cmakedefine AVM_DISABLE_POSTCONDITIONS

#ifdef AVM_MSVC
#ifdef AVM_BUILDING
#define AVMAPI extern __declspec(dllexport)
#else
#define AVMAPI extern __declspec(dllimport)
#endif
#else
#ifdef AVM_BUILDING
#define AVMAPI extern __attribute__((visibility("default")))
#else
#define AVMAPI extern
#endif
#endif

#if defined AVM_EXPOSE_HIDDEN_API && defined AVM_BUILDING
#undef AVMHIDDEN
#define AVMHIDDEN AVMAPI
#endif

#ifdef AVM_MSVC
#define AVM_NONNULL(...)
#define AVM_PURE
#ifndef alignof
#define alignof __alignof
#endif
#ifndef thread_local
#define thread_local __declspec(thread)
#endif
#define never __declspec(noreturn) void
#define typeof(T) decltype(T)
#else
#ifdef AVM_LINUX
#pragma weak AvmAlloc
#endif
#define AVM_NONNULL(...) __attribute__((nonnull(__VA_ARGS__)))
#define AVM_PURE         __attribute__((pure))
#ifndef alignof
#define alignof _Alignof
#endif
#ifndef thread_local
#define thread_local _Thread_local
#endif
#define never _Noreturn void
#ifdef __clang__
#pragma GCC diagnostic push
#pragma GCC diagnostic ignored "-Wkeyword-macro"
#endif
#define typeof(T) __typeof__(T)
#ifdef __clang__
#pragma GCC diagnostic pop
#endif
#endif // AVM_MSVC

#ifdef __cplusplus
#warning "Avium: C++ is not supported, you may encounter errors."
#endif

#define AVM_MAX_STRING_SIZE          ((uint)-1)
#define AVM_STRING_GROWTH_FACTOR     2
#define AVM_STRING_DEFAULT_CAPACITY  8
#define AVM_ARRAY_LIST_GROWTH_FACTOR 2

#define AVM_LONG_MIN_STR "-9223372036854775808"

#ifdef AVM_HAVE_UNICODE
#define AVM_FMT_UNICODE 'U'
#endif

#define AVM_FMT_INT_DECIMAL    'i'
#define AVM_FMT_INT_HEX        'x'
#define AVM_FMT_INT_BINARY     'b'
#define AVM_FMT_INT_OCTAL      'o'
#define AVM_FMT_INT_UNSIGNED   'u'
#define AVM_FMT_INT_SIZE       'z'
#define AVM_FMT_CHAR           'c'
#define AVM_FMT_FLOAT          'f'
#define AVM_FMT_FLOAT_EXP      'e'
#define AVM_FMT_FLOAT_AUTO     'g'
#define AVM_FMT_STRING         's'
#define AVM_FMT_BOOL           't'
#define AVM_FMT_POINTER        'p'
#define AVM_FMT_VALUE          'v'
#define AVM_FMT_TYPE           'T'
#define AVM_FMT_SIZE           'Z'
#define AVM_FMT_MEMBERS        'm'
#define AVM_FMT_TRUE           "true"
#define AVM_FMT_FALSE          "false"
#define AVM_FMT_HEX_PREFIX     "0x"
#define AVM_FMT_OCTAL_PREFIX   "0o"
#define AVM_FMT_BINARY_PREFIX  "0b"
#define AVM_FMT_UNICODE_PREFIX "U+"

#define _AVM_METADATA_BLOCK_NAME(T)    _Metadata_##T
#define _AVM_INTERFACE_IMPL_NAME(I, T) _Impl_##I##_##T
#define _AVM_INTERFACE_VTBL_NAME(I, T) _VTable_##I##_##T
#define _AVM_INTERFACE_BLOCK_NAME(T)   _Interfaces_##T
#define _AVM_MEMBER_BLOCK_NAME(T)      _Members_##T
#define _AVM_VTABLE_BLOCK_NAME(T)      _VTable_##T
#define _AVM_PARAMS_BLOCK_NAME(T)      _Params_##T

#define AVM_THREAD_DEFAULT_NAME "<anonymous>"
#define AVM_THREAD_MAIN_NAME    "main"

#define AVM_OBJECT_FMT_STR         "%s [%x]"
#define AVM_DETAILED_ERROR_FMT_STR "%s\n\nBacktrace:\n%v\n"
#define AVM_LOCATION_FMT_STR       "%s:%u:%u"
#define AVM_VERSION_FMT_STR        "%u.%u.%u"
#define AVM_THREAD_FMT_STR         "thread %s [%x]"
#define AVM_CAST_FAIL_FMT_STR      "Tried to cast object [%x] of type %T to type %s."
#define AVM_UNHANDLED_THROW_FMT_STR                                            \
    "Uncaught thrown object of type %T: %v\nThrown from %v while on thread "   \
    "[%x].\n"
#define AVM_BACKTRACE_MAX_SYMBOLS       128
#define AVM_BACKTRACE_LINE_SIZE         32
#define AVM_BACKTRACE_SEPARATOR         '@'
#define AVM_BACKTRACE_NOT_AVAILABLE_MSG "Backtrace not available."

#define AVM_DEBUG_SMASH_PROTECTOR_SIZE 64

#endif // AVIUM_CONFIG_H
